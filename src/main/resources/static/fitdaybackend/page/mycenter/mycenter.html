<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>个人中心</title>
        <link rel="stylesheet" href="../../../public/plugins/element-ui/index.css" />
        <style>
          .avatar-uploader .el-upload {
            border: 1px dashed #d9d9d9;
            border-radius: 6px;
            cursor: pointer;
            position: relative;
            overflow: hidden;
          }
          .avatar-uploader .el-upload:hover {
            border-color: #409EFF;
          }
          .avatar-uploader-icon {
            font-size: 28px;
            color: #8c939d;
            width: 178px;
            height: 178px;
            line-height: 178px;
            text-align: center;
          }
          .avatar {
            width: 178px;
            height: 178px;
            display: block;
          }
          .avatar-uploader{
              text-align: center;
          }
          label{
              font-weight: bold;
              font-size: 26px;
          }
          h3{
              display: inline-block;
              width: 130px;
          }
          .myrow{
              margin-top: 10px;
          }
          .el-tabs__item{
              font-size: 16px;
              font-weight: bold;
              
          }
        </style>
    </head>
    <body>
        <div id="app">
            
            <div class="banner" style="height: 120px; display: flex; background-image: url(../../images/222.jpg);">
                <img src="../../images/fitdaylogo.png" alt="" style="height:100px ;width:300px;margin:0 80px;">
                <span class="myfont" style="color: azure;
                font-size: 40px;
                line-height: 120px;
                margin-left: 100px;">吃好，练好，拥有好心态，轻装上阵！</span>
            </div>
            
            <h1 style="text-align: center;">个人中心</h1>
            
            <div class="main" style="padding: 0 40px;">
                <el-tabs tab-position="left" >
                    <el-tab-pane label="基本信息" style="margin:0 20px">
                        <div class="info" style="margin:0 30px">
                            <h3>当前头像</h3>
                            <div style="display: flex;margin: 20px;">
                                <el-avatar :size="180" :src="circleUrl"></el-avatar>
                                <el-button type="success" round style="margin-left: 50px; margin-top: 100px;height: 42px;" @click="changeVisible = true">修改头像</el-button>
                            </div>
                            
                            <el-dialog
                              title="上传新头像"
                              :visible.sync="changeVisible"
                              width="30%"
                              >
                              <el-upload
                                class="avatar-uploader"
                                action="https://jsonplaceholder.typicode.com/posts/"
                                :show-file-list="false"
                                :on-success="handleAvatarSuccess"
                                :before-upload="beforeAvatarUpload"
                              >
                                <img v-if="imageUrl" :src="imageUrl" class="avatar">
                                <i v-else class="el-icon-plus avatar-uploader-icon"></i>
                              </el-upload>
                              
                              <span slot="footer" class="dialog-footer">
                                <el-button type="primary" @click="changeVisible = false">确 定</el-button>
                                <el-button @click="changeVisible = false">取 消</el-button>
                              </span>
                            </el-dialog>
                            
                            <div class="myrow">
                                <h3>我的昵称</h3>
                                <el-input
                                  v-model="name"
                                  prefix-icon="el-icon-user-solid"
                                  style="width: 300px;"
                                  >
                                </el-input>
                            </div>
                            
                            <div class="myrow">
                                <h3>我的电话</h3>
                                <el-input
                                  v-model="phone"
                                  prefix-icon="el-icon-user-solid"
                                  style="width: 300px;"
                                  >
                                </el-input>
                            </div>
                            
                            <div class="myrow">
                                <h3>我的性别</h3>
                                <el-radio v-model="sex" label="0">男</el-radio>
                                <el-radio v-model="sex" label="1">女</el-radio>
                                <el-radio v-model="sex" label="2">保密</el-radio>
                            </div>
                            
                            <div class="myrow">
                                <h3>我的微信号</h3>
                                <el-input
                                  v-model="wxNumber"
                                  prefix-icon="el-icon-user-solid"
                                  style="width: 300px;"
                                  >
                                </el-input>
                            </div>
                        </div>
                        <div style="margin:18px 40px;">
                            <el-button type="primary" style="margin-left: 30px;">提交修改</el-button>
                            <el-button style="margin-left: 50px;">取消</el-button>
                        </div>
                        
                    </el-tab-pane>
                    <el-tab-pane label="修改密码">
                        <el-form label-position="top" label-width="80px" :model="formLabelAlign" style="margin:0 30px;">
                          <el-form-item label="请输入原密码">
                            <el-input v-model="formLabelAlign.code" style="width: 250px;"></el-input>
                          </el-form-item>
                          <el-form-item label="请输入新密码">
                            <el-input v-model="formLabelAlign.newcode" style="width: 250px;"></el-input>
                          </el-form-item>
                          <el-form-item label="请再次输入新密码进行确认">
                            <el-input v-model="formLabelAlign.newcodeagagin" style="width: 250px;"></el-input>
                          </el-form-item>
                          <el-form-item>
                            <el-button type="primary" @click="changecode">修改密码</el-button>
                            <el-button @click="newform" style="margin-left: 50px;">重置</el-button>
                          </el-form-item>
                        </el-form>
                    </el-tab-pane>
                    <el-tab-pane label="账号相关">
                        <div style="margin:0 30px;">
                            
                            <div class="myrow">
                                <h3>我的EID</h3>
                                {{empInfo.eid}}
                                44444
                            </div>
                            
                            <div class="myrow">
                                <h3>我的账号</h3>
                                {{empInfo.account}}
                                2222222222
                            </div>
                            
                            <div class="myrow">
                                <h3>绑定的手机号</h3>
                                {{empInfo.phone}}
                                33333333
                            </div>
                            
                            <div class="myrow">
                                <h3>绑定的微信号</h3>
                                {{empInfo.wxNumber}}
                                44444444
                            </div>
                            
                            <div class="myrow">
                                <h3>我的角色</h3>
                                {{empInfo.rolenum}}
                                5
                            </div>
                            
                            <div class="myrow">
                                <h3>账号创建时间</h3>
                                {{empInfo.createTime}}
                                6666
                            </div>
                            <el-button type="danger" style="margin: 20px;">注销账号</el-button>
                        </div>
                    </el-tab-pane>
                </el-tabs>
            </div>
        </div>
        <!-- 开发环境版本，包含了有帮助的命令行警告 -->
        <script src="../../../public/plugins/vue/vue.js"></script>
        <!-- 引入组件库 -->
        <script src="../../../public/plugins/element-ui/index.js"></script>
        <script>
            new Vue({
                el: '#app',
                data() {
                    return {
                        empInfo: {},
                        name:"",
                        phone:"",
                        sex:"",
                        wxNumber:"",
                        changeVisible:false,
                        circleUrl:'https://cube.elemecdn.com/e/fd/0fc7d20532fdaf769a25683617711png.png',
                        imageUrl: '',
                        formLabelAlign: {
                          name: '',
                          code: '',
                          newcode: ''
                        }
                    }
                },
                mounted() {
                  var empInfo = window.localStorage.getItem('empInfo')
                  empInfo = JSON.parse(empInfo)
                  this.name=empInfo.name
                  this.phone=empInfo.phone
                  this.sex=empInfo.sex
                  this.circleUrl=empInfo.avatar
                  this.wxNumber=empInfo.wxNumber
                },
                methods: {
                    handleOpen(key, keyPath) {
                        console.log(key, keyPath);
                    },
                    handleClose(key, keyPath) {
                        console.log(key, keyPath);
                    },
                    handleAvatarSuccess(res, file) {
                        this.imageUrl = URL.createObjectURL(file.raw);
                        this.$forceUpdate() // 触发强制刷新
                    },
                    beforeAvatarUpload(file) {
                      const isJPEG = file.type === 'image/jpeg'
                      const isPNG = file.type === 'image/png'
                      const isJPG = file.type === 'image/jpg'
                      const isLt2M = file.size / 1024 / 1024 < 2;
                      if (!isJPG && !isPNG && !isJPEG) {
                        this.$message.error('上传图片只能是jpg，png，jpeg格式!');
                        return false
                      }
                      if (!isLt2M) {
                        this.$message.error('上传头像图片大小不能超过 2MB!');
                        return false
                      }
                      return true;
                    }
                }
            })
        </script>
    </body>
</html>
