<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>首页</title>
        <link rel="stylesheet" href="../public/plugins/element-ui/index.css" />
        <link rel="shortcut icon" href="../public/favicon.ico">
        <style type="text/css">
        #user{
            float: right;
        }
        .el-main{
            padding: 0px;
        }
        .el-avatar{
            background:#FFFFFF;
        }
        </style>
    </head>
    <body>
        <div id="app">
            <el-container>
                
                <el-header>
                    <el-menu 
                    default-active="1" 
                    class="el-menu-demo" 
                    mode="horizontal" 
                    @select="selectMenu"
                    text-color="#000000"
                    active-text-color="#003bff"
                    >
                      <el-menu-item index="0" style="border-bottom: none;text-decoration: none;">
                          <div>
                            <img src="assets/img/fitdaylogo.png" alt="" style="width: 142px; height: 50px;margin-bottom:8px;" />
                          </div>
                      </el-menu-item>
                      <el-menu-item index="1">首页</el-menu-item>
                      <el-menu-item index="2">饮食计划</el-menu-item>
                      <el-menu-item index="3">运动计划</el-menu-item>
                      <el-menu-item index="4">小组</el-menu-item>
                      <el-menu-item index="5">社区</el-menu-item>
                      <el-menu-item index="6">商城</el-menu-item>
                      <el-menu-item index="7">心理咨询</el-menu-item>
                        <el-menu-item id="user" index="8" style="border-bottom: none;text-decoration: none;">
                          <div>
                              <el-dropdown @command="handleCommand">
                                <span style="cursor: pointer;">
                                  <span style="margin:0 15px 8px 0;"><el-avatar size="medium" :src="circleUrl"></el-avatar></span>
                                  <span>{{userInfo.username}}</span>
                                  <i class="el-icon-caret-bottom"></i>
                                </span>
                                <el-dropdown-menu slot="dropdown">
                                <el-dropdown-item icon="el-icon-user-solid" command="a"> 个人中心 </el-dropdown-item>
                                <el-dropdown-item icon="el-icon-message-solid" command="b"> 查看消息 </el-dropdown-item>
                                <el-dropdown-item icon="el-icon-switch-button" divided command="c"> 退出登录 </el-dropdown-item>
                              </el-dropdown-menu>
                            </el-dropdown>  
                          </div>
                      </el-menu-item>
                    </el-menu>
    
                </el-header>
                
            </el-container>
                
            <el-container>
                <el-main>
                    <iframe
                      id="cIframe"
                      class="c_iframe"
                      name="cIframe"
                      :src="iframeUrl"
                      width="100%"
                      :height="myheight"
                      frameborder="0"
                      scrolling="no"
                    ></iframe>
                </el-main>
            </el-container>
            
        </div>
        <!-- 开发环境版本，包含了有帮助的命令行警告 -->
        <script src="../public/plugins/vue/vue.js"></script>
        <!-- 引入组件库 -->
        <script src="../public/plugins/element-ui/index.js"></script>
        <script src="../public/plugins/axios/axios.min.js"></script>
        <script src="../public/js/request.js"></script>
        <script src="./myapi/userlogin.js"></script>
        <script>
            new Vue({
                el: '#app',
                data() {
                    return {
                        urlList: [
                            './page/home/home.html',
                            './page/food/food.html',
                            './page/sport/sport.html',
                            'page/users/list4.html',
                            './page/community/community.html',
                            './page/mall/course.html',
                            'page/users/list7.html'
                        ],
                        heightlist:[
                          "1180px",
                          "660px",
                          "1160px",
                          "1180px",
                          "1960px",
                          "1280px",
                          "1280px"
                        ],
                        userInfo:{},
                        iframeUrl: './page/home/home.html',
                        headTitle: '用户管理',
                        circleUrl:'https://cube.elemecdn.com/e/fd/0fc7d20532fdaf769a25683617711png.png',
                        myheight:"1180px"
                    }
                },
                mounted(){
                    var userInfo = window.localStorage.getItem('userInfo')
                    userInfo = JSON.parse(userInfo)
                    this.userInfo=userInfo
                    this.circleUrl=userInfo.avatar
                },
                methods: {
                    selectMenu(key, keyPath) {
                        if(key==0){
                            this.iframeUrl=this.urlList[0];
                        }else if(key==8){
                            this.iframeUrl=this.iframeUrl;
                        }else {
                            this.iframeUrl=this.urlList[key-1];
                            this.myheight=this.heightlist[key-1];
                        }
                    },
                    handleCommand(command) {
                        if(command=='a'){
                            window.location.href = './page/mycenter/mycenter.html';
                        }else if(command=='c'){
                            this.logout()
                        }
                    },
                    logout() {
                        userlogoutApi().then((res)=>{
                            if(res.code === 1){
                                localStorage.removeItem('userInfo')
                                window.location.href = './page/login/login.html'
                            }
                        })
                    },
                }
            })
        </script>
    </body>
</html>
